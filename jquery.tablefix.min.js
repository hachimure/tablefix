(function(e){e.fn.tablefix=function(t){return this.each(function(n){var r=e.extend({},t);var i=e(this);var s=r.width>0;var o=r.height>0;if(s){s=r.width<i.width()}else{r.width=i.width()}if(o){o=r.height<i.height()}else{r.height=i.height()}if(s||o){if(s&&o){r.width-=40;r.height-=40}else if(s){r.width-=20}else{r.height-=20}}else{return}i.wrap("<div></div>");var u=i.parent();u.css({position:"relative"});var a=r.fixRows>0?r.fixRows:0;var f=r.fixCols>0?r.fixCols:0;var l=0;var c=0;i.find("tr").each(function(t){e(this).find("td,th").each(function(n){if(t==a&&n==f){var r=e(this);l=r.position().left;c=r.parent("tr").position().top;return false}});if(t==a){return false}});var h=i.wrap("<div></div>");var p=i.clone().wrap("<div></div>");var d=i.clone().wrap("<div></div>");var v=i.clone().wrap("<div></div>");var m=h.parent().css({position:"absolute",overflow:"hidden"});var g=p.parent().css({position:"absolute",overflow:"hidden"});var y=d.parent().css({position:"absolute",overflow:"hidden"});var b=v.parent().css({position:"absolute",overflow:"auto"});u.append(g).append(y).append(b);var w=r.width-l;var E=r.height-c;var S=document.createElement("p");S.style.width="100%";S.style.height="200px";var x=document.createElement("div");x.style.position="absolute";x.style.top="0px";x.style.left="0px";x.style.visibility="hidden";x.style.width="200px";x.style.height="150px";x.style.overflow="hidden";x.appendChild(S);document.body.appendChild(x);var T=S.offsetWidth;x.style.overflow="scroll";var N=S.offsetWidth;if(T==N)N=x.clientWidth;document.body.removeChild(x);var C=T-N;m.width(l).height(c);g.width(w+(s?20:0)+(o?20:0)).height(c).css({left:l+"px"});p.css({marginLeft:-l+"px",marginRight:(s?20:0)+(o?20:0)+"px"});y.width(l).height(E+(s?20:0)+(o?20:0)).css({top:c+"px"});d.css({marginTop:-c+"px",marginBottom:(s?20:0)+(o?20:0)+"px"});b.width(w+(s?20:0)+(o?20:0)+C).height(E+(s?20:0)+(o?20:0)).css({left:l+"px",top:c+"px"});v.css({marginLeft:-l+"px",marginTop:-c+"px",marginRight:(s?20:0)+"px",marginBottom:(o?20:0)+"px"});if(o){p.width(v.width())}b.scroll(function(){g.scrollLeft(b.scrollLeft());y.scrollTop(b.scrollTop())});u.width(r.width+(s?20:0)+(o?20:0)).height(r.height+(s?20:0)+(o?20:0))})}})(jQuery)
